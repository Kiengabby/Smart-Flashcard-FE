<div class="quiz-result-container">
  <!-- Loading State -->
  <div class="loading-container" *ngIf="isLoading">
    <nz-spin nzSize="large">
      <div class="loading-text">
        <h3>ƒêang t·∫£i k·∫øt qu·∫£...</h3>
        <p>Vui l√≤ng ch·ªù trong gi√¢y l√°t</p>
      </div>
    </nz-spin>
  </div>

  <!-- Result Content -->
  <div class="result-content" *ngIf="!isLoading && result">
    
    <!-- Main Result -->
    <nz-result 
      [nzStatus]="getResultStatus()" 
      [nzIcon]="getResultIcon()"
      [nzTitle]="'B·∫°n ƒë√£ ho√†n th√†nh quiz!'"
      [nzSubTitle]="result.message"
      class="main-result">
      
      <!-- Score Progress -->
      <div nz-result-content>
        <div class="score-section">
          <div class="score-circle">
            <nz-progress
              [nzPercent]="result.accuracyPercentage"
              nzType="circle"
              [nzWidth]="120"
              [nzStrokeColor]="getProgressColor()"
              [nzFormat]="progressFormatter">
            </nz-progress>
          </div>
        </div>
      </div>
    </nz-result>

    <!-- Detailed Stats -->
    <div class="stats-grid">
      <nz-card class="stat-card">
        <nz-statistic
          nzTitle="T·ªïng c√¢u h·ªèi"
          [nzValue]="result.totalQuestions"
          [nzValueStyle]="{ color: '#3f8600' }"
          nzPrefix="üìù">
        </nz-statistic>
      </nz-card>

      <nz-card class="stat-card">
        <nz-statistic
          nzTitle="C√¢u tr·∫£ l·ªùi ƒë√∫ng"
          [nzValue]="result.correctAnswers"
          [nzValueStyle]="{ color: '#52c41a' }"
          nzPrefix="‚úÖ">
        </nz-statistic>
      </nz-card>

      <nz-card class="stat-card">
        <nz-statistic
          nzTitle="C√¢u tr·∫£ l·ªùi sai"
          [nzValue]="result.wrongAnswers"
          [nzValueStyle]="{ color: '#ff4d4f' }"
          nzPrefix="‚ùå">
        </nz-statistic>
      </nz-card>

      <nz-card class="stat-card">
        <nz-statistic
          nzTitle="Th·ªùi gian ho√†n th√†nh"
          [nzValue]="formatTime(result.totalTimeSeconds)"
          [nzValueStyle]="{ color: '#1890ff' }"
          nzPrefix="‚è±Ô∏è">
        </nz-statistic>
      </nz-card>
    </div>

    <!-- Performance Analysis -->
    <nz-card class="analysis-card" nzTitle="Ph√¢n t√≠ch k·∫øt qu·∫£">
      <div class="analysis-content">
        <div class="performance-bar">
          <div class="bar-label">ƒê·ªô ch√≠nh x√°c</div>
          <nz-progress 
            [nzPercent]="result.accuracyPercentage" 
            [nzStrokeColor]="getProgressColor()"
            [nzShowInfo]="true"
            class="performance-progress">
          </nz-progress>
        </div>

        <div class="recommendations" *ngIf="result.accuracyPercentage < 80">
          <h4>üí° G·ª£i √Ω c·∫£i thi·ªán:</h4>
          <ul>
            <li *ngIf="result.accuracyPercentage < 60">
              H√£y √¥n l·∫°i c√°c th·∫ª b·∫±ng ch·∫ø ƒë·ªô Flashcard tr∆∞·ªõc khi l√†m quiz l·∫ßn n·ªØa
            </li>
            <li *ngIf="result.accuracyPercentage >= 60 && result.accuracyPercentage < 80">
              B·∫°n ƒë√£ ti·∫øn b·ªô! Ti·∫øp t·ª•c luy·ªán t·∫≠p ƒë·ªÉ ƒë·∫°t k·∫øt qu·∫£ t·ªët h∆°n
            </li>
            <li>
              T·∫≠p trung v√†o {{ result.wrongAnswers }} th·∫ª b·∫°n ƒë√£ tr·∫£ l·ªùi sai
            </li>
          </ul>
        </div>

        <div class="congratulations" *ngIf="result.accuracyPercentage >= 80">
          <h4>üéâ Ch√∫c m·ª´ng!</h4>
          <p>B·∫°n ƒë√£ th√†nh th·∫°o r·∫•t t·ªët b·ªô th·∫ª n√†y. H√£y ti·∫øp t·ª•c v·ªõi c√°c b·ªô th·∫ª kh√°c!</p>
        </div>
      </div>
    </nz-card>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button 
        nz-button 
        nzType="default" 
        nzSize="large"
        (click)="backToStudyMode()"
        class="action-button">
        <span nz-icon nzType="arrow-left" nzTheme="outline"></span>
        Quay l·∫°i Study Mode
      </button>

      <button 
        nz-button 
        nzType="primary" 
        nzSize="large"
        (click)="retakeQuiz()"
        class="action-button">
        <span nz-icon nzType="redo" nzTheme="outline"></span>
        L√†m l·∫°i Quiz
      </button>

      <button 
        nz-button 
        nzType="dashed" 
        nzSize="large"
        (click)="continueWithFlashcard()"
        class="action-button">
        <span nz-icon nzType="file-text" nzTheme="outline"></span>
        H·ªçc Flashcard
      </button>
    </div>
  </div>
</div>