<div class="dashboard-container">
  
  <div class="welcome-header compact">
    <div class="welcome-background">
      <div class="floating-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
      </div>
    </div>

    <div class="welcome-content">
      <div class="greeting-section">
        <div class="greeting-icon">
          <span nz-icon nzType="smile" nzTheme="fill"></span>
        </div>
        <h1 class="welcome-title">
          Xin ch√†o, <span class="username">{{ currentUser.name || 'B·∫°n' }}</span>! 
          <span class="wave-emoji">üëã</span>
        </h1>
        <p class="welcome-subtitle">{{ getRandomMotivation() }}</p>
      </div>
    </div>
  </div>

  <div class="quick-stats" id="stats-overview">
    <nz-row [nzGutter]="[16, 16]">
      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card conquered-decks">
          <div class="stat-icon">
            <span nz-icon nzType="trophy" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value">{{ stats.conqueredDecks }}</div>
            <div class="stat-label">B·ªô th·∫ª ƒë√£ chinh ph·ª•c</div>
          </div>
        </div>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card study-streak" id="study-streak">
          <div class="stat-icon">
            <span nz-icon nzType="fire" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value">{{ stats.studyStreak }}</div>
            <div class="stat-label">Chu·ªói ng√†y h·ªçc li√™n ti·∫øp</div>
          </div>
        </div>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card total-words">
          <div class="stat-icon">
            <span nz-icon nzType="book" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value">{{ stats.totalWordsLearned }}</div>
            <div class="stat-label">T·ªïng t·ª´ ƒë√£ h·ªçc</div>
          </div>
        </div>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card review-today" id="review-today-card">
          <div class="stat-icon">
            <span nz-icon nzType="calendar" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value highlight">{{ stats.reviewToday }}</div>
            <div class="stat-label">Th·∫ª c·∫ßn √¥n h√¥m nay</div>
          </div>
        </div>
      </nz-col>
    </nz-row>
  </div>

  <div class="content-grid">
    <nz-row [nzGutter]="[16, 16]">
      <nz-col [nzXs]="24" [nzLg]="16">
        <nz-card class="action-card daily-review-card" *ngIf="stats.reviewToday > 0">
          <div class="action-content">
            <div class="action-header">
              <span nz-icon nzType="bell" nzTheme="fill" class="action-icon"></span>
              <div class="action-text">
                <h3>ƒê√£ ƒë·∫øn gi·ªù √¥n t·∫≠p r·ªìi! üéØ</h3>
                <p>B·∫°n c√≥ <strong>{{ stats.reviewToday }} th·∫ª</strong> c·∫ßn √¥n t·∫≠p h√¥m nay</p>
              </div>
            </div>
            <button nz-button nzType="primary" nzSize="large" class="action-button" (click)="navigateToDailyReview()">
              <span nz-icon nzType="play-circle" nzTheme="fill"></span>
              B·∫Øt ƒë·∫ßu √în t·∫≠p
            </button>
          </div>
        </nz-card>

        <nz-card class="section-card challenge-notifications-card" [nzTitle]="challengesTitle">
          <ng-template #challengesTitle>
            <div class="section-header">
              <span nz-icon nzType="team" nzTheme="outline"></span>
              <span class="section-title">Th√¥ng b√°o th√°ch ƒë·∫•u</span>
              <span class="notification-badge" *ngIf="challengeNotifications.length > 0">
                {{ challengeNotifications.length }}
              </span>
            </div>
          </ng-template>

          <!-- Empty State -->
          <nz-empty 
            *ngIf="challengeNotifications.length === 0"
            nzNotFoundImage="simple"
            style="padding: 20px;">
            <div nz-empty-footer style="text-align: center;">
              <h4 style="font-size: 16px; margin-bottom: 8px;">ü§ù Ch∆∞a c√≥ th√°ch ƒë·∫•u n√†o</h4>
              <p style="color: #8c8c8c; font-size: 14px;">M·ªùi b·∫°n b√® tham gia th√°ch ƒë·∫•u ƒë·ªÉ h·ªçc t·∫≠p c√πng nhau!</p>
            </div>
          </nz-empty>

          <!-- Challenge Notifications List -->
          <div class="challenges-list" *ngIf="challengeNotifications.length > 0">
            <div 
              *ngFor="let challenge of challengeNotifications" 
              class="challenge-item"
              [class.new]="challenge.isNew">
              
              <div class="challenge-avatar">
                <nz-avatar 
                  [nzSrc]="challenge.senderAvatar" 
                  [nzText]="challenge.senderName.charAt(0)"
                  nzSize="small">
                </nz-avatar>
                <span class="challenge-type-icon" [class]="challenge.type">
                  <span nz-icon [nzType]="getChallengeIcon(challenge.type)" nzTheme="fill"></span>
                </span>
              </div>

              <div class="challenge-content">
                <div class="challenge-header">
                  <span class="challenge-sender">{{ challenge.senderName }}</span>
                  <span class="challenge-time">{{ challenge.timeAgo }}</span>
                </div>
                <div class="challenge-message">{{ challenge.message }}</div>
                <div class="challenge-details">
                  <span class="challenge-deck">üìö {{ challenge.deckName }}</span>
                  <span class="challenge-target">üéØ {{ challenge.target }}</span>
                </div>
              </div>

              <div class="challenge-actions">
                <button 
                  nz-button 
                  nzType="primary" 
                  nzSize="small"
                  (click)="acceptChallenge(challenge)">
                  <span nz-icon nzType="check"></span>
                  Ch·∫•p nh·∫≠n
                </button>
                <button 
                  nz-button 
                  nzType="default" 
                  nzSize="small"
                  (click)="declineChallenge(challenge)">
                  <span nz-icon nzType="close"></span>
                  T·ª´ ch·ªëi
                </button>
              </div>
            </div>
          </div>
        </nz-card>
      </nz-col>

      <nz-col [nzXs]="24" [nzLg]="8">
        <nz-card class="section-card streak-card compact" [nzTitle]="streakTitle">
          <ng-template #streakTitle>
            <div class="section-header">
              <span nz-icon nzType="fire" nzTheme="fill" style="color: #ff922b;"></span>
              <span class="section-title">Chu·ªói ng√†y h·ªçc</span>
            </div>
          </ng-template>

          <div class="streak-display">
            <div class="streak-number">{{ stats.studyStreak }}</div>
            <div class="streak-label">ng√†y li√™n ti·∫øp</div>
            <div class="streak-message">Tuy·ªát v·ªùi! H√£y ti·∫øp t·ª•c! üí™</div>
          </div>

          <div class="calendar-mini compact">
            <div class="calendar-header">
              <button nz-button nzType="link" nzSize="small" (click)="previousMonth()">
                <span nz-icon nzType="left"></span>
              </button>
              <span class="current-month">Th√°ng {{ currentMonth }}</span>
              <button nz-button nzType="link" nzSize="small" (click)="nextMonth()">
                <span nz-icon nzType="right"></span>
              </button>
            </div>
            
            <div class="calendar-grid">
              <div class="calendar-weekdays">
                <div class="weekday">CN</div>
                <div class="weekday">T2</div>
                <div class="weekday">T3</div>
                <div class="weekday">T4</div>
                <div class="weekday">T5</div>
                <div class="weekday">T6</div>
                <div class="weekday">T7</div>
              </div>
              
              <div class="calendar-days">
                <div 
                  *ngFor="let day of calendarDays"
                  class="calendar-day"
                  [class.other-month]="!day.currentMonth"
                  [class.today]="day.isToday"
                  [class.has-activity]="day.hasActivity"
                  [class.level-1]="day.activityLevel === 1"
                  [class.level-2]="day.activityLevel === 2"
                  [class.level-3]="day.activityLevel === 3"
                >
                  <span class="day-number">{{ day.date }}</span>
                  <span nz-icon nzType="fire" nzTheme="fill" class="fire-icon" *ngIf="day.hasActivity"></span>
                </div>
              </div>
            </div>
          </div>
        </nz-card>
      </nz-col>
    </nz-row>
  </div>

</div>
