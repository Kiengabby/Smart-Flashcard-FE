<div class="dashboard-container">
  
  <div class="welcome-header">
    <div class="welcome-content">
      <h1 class="welcome-title">
        Xin ch√†o, {{ currentUser.name }}! üëã
      </h1>
      <p class="welcome-subtitle">H√£y ti·∫øp t·ª•c h√†nh tr√¨nh chinh ph·ª•c ng√¥n ng·ªØ c·ªßa b·∫°n h√¥m nay</p>
    </div>
  </div>

  <div class="quick-stats" id="stats-overview">
    <nz-row [nzGutter]="[16, 16]">
      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card conquered-decks">
          <div class="stat-icon">
            <span nz-icon nzType="trophy" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value">{{ stats.conqueredDecks }}</div>
            <div class="stat-label">B·ªô th·∫ª ƒë√£ chinh ph·ª•c</div>
          </div>
        </div>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card study-streak" id="study-streak">
          <div class="stat-icon">
            <span nz-icon nzType="fire" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value">{{ stats.studyStreak }}</div>
            <div class="stat-label">Chu·ªói ng√†y h·ªçc li√™n ti·∫øp</div>
          </div>
        </div>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card total-words">
          <div class="stat-icon">
            <span nz-icon nzType="book" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value">{{ stats.totalWordsLearned }}</div>
            <div class="stat-label">T·ªïng t·ª´ ƒë√£ h·ªçc</div>
          </div>
        </div>
      </nz-col>

      <nz-col [nzXs]="24" [nzSm]="12" [nzLg]="6">
        <div class="stat-card review-today" id="review-today-card">
          <div class="stat-icon">
            <span nz-icon nzType="calendar" nzTheme="fill"></span>
          </div>
          <div class="stat-info">
            <div class="stat-value highlight">{{ stats.reviewToday }}</div>
            <div class="stat-label">Th·∫ª c·∫ßn √¥n h√¥m nay</div>
          </div>
        </div>
      </nz-col>
    </nz-row>
  </div>

  <div class="content-grid">
    <nz-row [nzGutter]="[16, 16]">
      <nz-col [nzXs]="24" [nzLg]="16">
        <nz-card class="action-card daily-review-card" *ngIf="stats.reviewToday > 0">
          <div class="action-content">
            <div class="action-header">
              <span nz-icon nzType="bell" nzTheme="fill" class="action-icon"></span>
              <div class="action-text">
                <h3>ƒê√£ ƒë·∫øn gi·ªù √¥n t·∫≠p r·ªìi! üéØ</h3>
                <p>B·∫°n c√≥ <strong>{{ stats.reviewToday }} th·∫ª</strong> c·∫ßn √¥n t·∫≠p h√¥m nay</p>
              </div>
            </div>
            <button nz-button nzType="primary" nzSize="large" class="action-button">
              <span nz-icon nzType="play-circle" nzTheme="fill"></span>
              B·∫Øt ƒë·∫ßu √în t·∫≠p
            </button>
          </div>
        </nz-card>

        <nz-card class="section-card my-decks-card" [nzTitle]="decksTitle">
          <ng-template #decksTitle>
            <div class="section-header">
              <span nz-icon nzType="folder" nzTheme="outline"></span>
              <span class="section-title">B·ªô th·∫ª c·ªßa t√¥i</span>
              <button 
                nz-button 
                nzType="primary" 
                nzSize="small" 
                class="create-deck-btn"
                id="create-deck-btn"
                (click)="openCreateDeckModal()">
                <span nz-icon nzType="plus"></span>
                T·∫°o b·ªô th·∫ª m·ªõi
              </button>
            </div>
          </ng-template>

          <!-- Loading State -->
          <div *ngIf="isLoading" style="text-align: center; padding: 40px;">
            <nz-spin nzSimple [nzSize]="'large'"></nz-spin>
            <p style="margin-top: 16px; color: #8c8c8c;">ƒêang t·∫£i danh s√°ch b·ªô th·∫ª...</p>
          </div>

          <!-- Empty State -->
          <nz-empty 
            *ngIf="!isLoading && !decks.length"
            nzNotFoundImage="simple"
            style="padding: 40px 20px;">
            <div nz-empty-footer style="text-align: center;">
              <h3 style="font-size: 18px; margin-bottom: 12px;">üìö Ch∆∞a c√≥ b·ªô th·∫ª n√†o</h3>
              <p style="color: #8c8c8c; margin-bottom: 20px;">T·∫°o b·ªô th·∫ª ƒë·∫ßu ti√™n ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh chinh ph·ª•c t·ª´ v·ª±ng!</p>
              <button 
                nz-button 
                nzType="primary" 
                nzSize="large"
                (click)="openCreateDeckModal()">
                  <span nz-icon nzType="plus"></span>
                  T·∫°o b·ªô th·∫ª ƒë·∫ßu ti√™n
                </button>
            </div>
          </nz-empty>

          <!-- Deck List -->
          <div class="decks-grid" id="deck-list" *ngIf="!isLoading && decks.length">
            <nz-row [nzGutter]="[12, 12]">
              <nz-col 
                *ngFor="let deck of decks" 
                [nzXs]="24" 
                [nzSm]="12" 
                [nzMd]="8">
                <div 
                  class="deck-item" 
                  [class.conquered]="calculateProgress(deck) >= 100"
                  (click)="viewDeckDetail(deck)"
                  style="cursor: pointer;">
                  <div class="deck-header">
                    <div 
                      class="deck-badge" 
                      [class.conquered]="calculateProgress(deck) >= 100">
                      {{ calculateProgress(deck) >= 100 ? '‚úÖ Ho√†n th√†nh' : 'üöÄ M·ªõi' }}
                    </div>
                    <span nz-icon nzType="more" class="deck-menu" (click)="$event.stopPropagation(); openDeckSettings(deck)"></span>
                  </div>
                  <div class="deck-title">{{ deck.name }}</div>
                  <div class="deck-description">{{ deck.description }}</div>
                  <div class="deck-stats">
                    <span class="deck-count">
                      <span nz-icon nzType="file-text"></span>
                      {{ deck.cardCount || 0 }} th·∫ª
                    </span>
                    <span 
                      class="deck-progress" 
                      [class.conquered]="calculateProgress(deck) >= 100">
                      <span 
                        nz-icon 
                        [nzType]="calculateProgress(deck) >= 100 ? 'check-circle' : 'rocket'" 
                        nzTheme="fill"></span>
                      {{ calculateProgress(deck) >= 100 ? 'ƒê√£ chinh ph·ª•c' : 'S·∫µn s√†ng h·ªçc' }}
                    </span>
                  </div>
                  <button 
                    nz-button 
                    nzBlock 
                    [nzType]="calculateProgress(deck) >= 100 ? 'default' : 'primary'" 
                    class="deck-action"
                    (click)="$event.stopPropagation(); startStudying(deck)">
                    {{ calculateProgress(deck) >= 100 ? '√în t·∫≠p l·∫°i' : 'B·∫Øt ƒë·∫ßu Chinh ph·ª•c' }}
                  </button>
                </div>
              </nz-col>
            </nz-row>
          </div>
        </nz-card>
      </nz-col>

      <nz-col [nzXs]="24" [nzLg]="8">
        <nz-card class="section-card streak-card" [nzTitle]="streakTitle">
          <ng-template #streakTitle>
            <div class="section-header">
              <span nz-icon nzType="fire" nzTheme="fill" style="color: #ff922b;"></span>
              <span class="section-title">Chu·ªói ng√†y h·ªçc</span>
            </div>
          </ng-template>

          <div class="streak-display">
            <div class="streak-number">{{ stats.studyStreak }}</div>
            <div class="streak-label">ng√†y li√™n ti·∫øp</div>
            <div class="streak-message">Tuy·ªát v·ªùi! H√£y ti·∫øp t·ª•c ph·∫•n ƒë·∫•u! üí™</div>
          </div>

          <div class="calendar-mini">
            <div class="calendar-header">
              <button nz-button nzType="link" nzSize="small" (click)="previousMonth()">
                <span nz-icon nzType="left"></span>
              </button>
              <span class="current-month">Th√°ng {{ currentMonth }}</span>
              <button nz-button nzType="link" nzSize="small" (click)="nextMonth()">
                <span nz-icon nzType="right"></span>
              </button>
            </div>
            
            <div class="calendar-grid">
              <div class="calendar-weekdays">
                <div class="weekday">CN</div>
                <div class="weekday">T2</div>
                <div class="weekday">T3</div>
                <div class="weekday">T4</div>
                <div class="weekday">T5</div>
                <div class="weekday">T6</div>
                <div class="weekday">T7</div>
              </div>
              
              <div class="calendar-days">
                <div 
                  *ngFor="let day of calendarDays"
                  class="calendar-day"
                  [class.other-month]="!day.currentMonth"
                  [class.today]="day.isToday"
                  [class.has-activity]="day.hasActivity"
                  [class.level-1]="day.activityLevel === 1"
                  [class.level-2]="day.activityLevel === 2"
                  [class.level-3]="day.activityLevel === 3"
                >
                  {{ day.date }}
                </div>
              </div>
            </div>
          </div>
        </nz-card>

        <nz-card class="section-card challenges-card" [nzTitle]="challengesTitle" id="challenges-section">
          <ng-template #challengesTitle>
            <div class="section-header">
              <span nz-icon nzType="trophy" nzTheme="outline"></span>
              <span class="section-title">Th√°ch ƒë·∫•u</span>
            </div>
          </ng-template>

          <div class="challenge-empty">
            <span nz-icon nzType="inbox" style="font-size: 48px; color: #d9d9d9;"></span>
            <p>Ch∆∞a c√≥ l·ªùi th√°ch ƒë·∫•u n√†o</p>
            <button nz-button nzType="default">
              <span nz-icon nzType="user-add"></span>
              T√¨m b·∫°n b√®
            </button>
          </div>
        </nz-card>
      </nz-col>
    </nz-row>
  </div>

</div>
